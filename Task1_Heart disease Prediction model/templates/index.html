<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heart Disease Prediction</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-heartbeat"></i>
                <span>Heart Disease Prediction</span>
            </div>
            <div class="nav-links">
                <a href="#" class="nav-link active">
                    <i class="fas fa-home"></i>
                    <span>Home</span>
                </a>
                <a href="#about" class="nav-link">
                    <i class="fas fa-info-circle"></i>
                    <span>About</span>
                </a>
                <a href="#contact" class="nav-link">
                    <i class="fas fa-envelope"></i>
                    <span>Contact</span>
                </a>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="welcome-section">
            <h1>Heart Disease Risk Assessment</h1>
            <div class="disclaimer">
                <i class="fas fa-shield-alt"></i>
                <div>
                    <p>This tool is designed for <strong>healthcare professionals</strong> or users with access to medical data. 
                    It does <u>not</u> replace medical consultation. Always seek advice from a licensed doctor for proper diagnosis and treatment.</p>
                </div>
            </div>
        </div>

        <form action="/predict" method="post" id="predictionForm">
            <div class="form-grid">
                <div class="form-group">
                    <label for="Age">Age <i class="fas fa-info-circle" title="Enter your age in years"></i></label>
                    <input type="number" id="Age" name="Age" min="1" max="120" required>
                </div>

                <div class="form-group">
                    <label for="Sex">Sex <i class="fas fa-info-circle" title="Select your biological sex"></i></label>
                    <select id="Sex" name="Sex" required>
                        <option value="0">Female</option>
                        <option value="1">Male</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="ChestPainType">Chest Pain Type <i class="fas fa-info-circle" title="Type of chest pain experienced"></i></label>
                    <select id="ChestPainType" name="ChestPainType" required>
                        <option value="0">Typical Angina</option>
                        <option value="1">Atypical Angina</option>
                        <option value="2">Non-anginal Pain</option>
                        <option value="3">Asymptomatic</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="RestingBP">Resting Blood Pressure <i class="fas fa-info-circle" title="Resting blood pressure in mm Hg"></i></label>
                    <input type="number" id="RestingBP" name="RestingBP" min="60" max="200" required>
                </div>

                <div class="form-group">
                    <label for="Cholesterol">Cholesterol <i class="fas fa-info-circle" title="Cholesterol level in mg/dL"></i></label>
                    <input type="number" id="Cholesterol" name="Cholesterol" min="100" max="600" required>
                </div>

                <div class="form-group">
                    <label for="FastingBS">Fasting Blood Sugar <i class="fas fa-info-circle" title="Is fasting blood sugar > 120 mg/dL?"></i></label>
                    <select id="FastingBS" name="FastingBS" required>
                        <option value="0">No</option>
                        <option value="1">Yes</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="RestingECG">Resting ECG <i class="fas fa-info-circle" title="Results of resting ECG"></i></label>
                    <select id="RestingECG" name="RestingECG" required>
                        <option value="0">Normal</option>
                        <option value="1">ST-T Wave Abnormality</option>
                        <option value="2">Left Ventricular Hypertrophy</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="MaxHR">Max Heart Rate <i class="fas fa-info-circle" title="Maximum heart rate achieved"></i></label>
                    <input type="number" id="MaxHR" name="MaxHR" min="60" max="202" required>
                </div>

                <div class="form-group">
                    <label for="ExerciseAngina">Exercise Angina <i class="fas fa-info-circle" title="Exercise-induced chest pain"></i></label>
                    <select id="ExerciseAngina" name="ExerciseAngina" required>
                        <option value="0">No</option>
                        <option value="1">Yes</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="Oldpeak">ST Depression <i class="fas fa-info-circle" title="ST depression induced by exercise relative to rest"></i></label>
                    <input type="number" id="Oldpeak" name="Oldpeak" step="0.1" min="-2.6" max="6.2" required>
                </div>

                <div class="form-group">
                    <label for="ST_Slope">ST Slope <i class="fas fa-info-circle" title="Slope of the peak exercise ST segment"></i></label>
                    <select id="ST_Slope" name="ST_Slope" required>
                        <option value="0">Upsloping</option>
                        <option value="1">Flat</option>
                        <option value="2">Downsloping</option>
                    </select>
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="submit-btn">
                    <i class="fas fa-heartbeat"></i>
                    Analyze Risk
                </button>
            </div>
        </form>

        <div id="loading" class="loading-spinner" style="display: none;">
            <div class="spinner"></div>
            <p>Analyzing your data...</p>
        </div>

        {% if prediction_text %}
        <div class="result-card {% if 'ðŸš¨' in prediction_text %}danger{% else %}safe{% endif %}">
            <div class="result-icon">
                {% if 'ðŸš¨' in prediction_text %}
                <i class="fas fa-exclamation-circle"></i>
                {% else %}
                <i class="fas fa-check-circle"></i>
                {% endif %}
            </div>
            <div class="result-content">
                <h3>{{ prediction_text }}</h3>
                <p class="result-timestamp">Analysis completed at: {{ now().strftime('%Y-%m-%d %H:%M:%S') }}</p>
                
                <!-- Download Report Form -->
                <form action="{{ url_for('download_report') }}" method="post" class="download-form">
                    <input type="hidden" name="prediction_result" value="{{ prediction_text }}">
                    {% for value in input_data %}
                    <input type="hidden" name="input_data[]" value="{{ value }}">
                    {% endfor %}
                    <button type="submit" class="download-btn">
                        <i class="fas fa-file-pdf"></i>
                        Download Full Report
                    </button>
                </form>
                
                <!-- Manual Dashboard Button -->
                <button type="button" id="showDashboardBtn" class="dashboard-btn">
                    <i class="fas fa-chart-bar"></i>
                    Show Health Dashboard
                </button>
            </div>
        </div>
        {% endif %}

        <!-- Health Dashboard Section -->
        <div id="dashboard" class="dashboard" style="display: none;">
            <div class="dashboard-header">
                <h2><i class="fas fa-chart-line"></i> Your Health Dashboard</h2>
                <p class="dashboard-subtitle">Comprehensive analysis of your cardiovascular health metrics</p>
            </div>
            
            <!-- Primary Metrics Section -->
            <div class="dashboard-section">
                <h3 class="section-title"><i class="fas fa-heartbeat"></i> Primary Health Metrics</h3>
                <div class="dashboard-grid primary-grid">
                    <!-- Bar Chart: Input vs Normal Values -->
                    <div class="dashboard-card primary-card">
                        <div class="card-header">
                            <h4><i class="fas fa-chart-bar"></i> Vital Signs Comparison</h4>
                            <p class="card-subtitle">Your values vs. healthy ranges</p>
                        </div>
                        <canvas id="vitalSignsChart"></canvas>
                    </div>
                    
                    <!-- Pie Chart: Risk Breakdown -->
                    <div class="dashboard-card primary-card">
                        <div class="card-header">
                            <h4><i class="fas fa-chart-pie"></i> Risk Assessment</h4>
                            <p class="card-subtitle">Heart disease risk distribution</p>
                        </div>
                        <canvas id="riskDistributionChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Detailed Analysis Section -->
            <div class="dashboard-section">
                <h3 class="section-title"><i class="fas fa-microscope"></i> Detailed Analysis</h3>
                <div class="dashboard-grid secondary-grid">
                    <!-- Radar Chart: Cardiovascular Profile -->
                    <div class="dashboard-card secondary-card">
                        <div class="card-header">
                            <h4><i class="fas fa-radar"></i> Cardiovascular Profile</h4>
                            <p class="card-subtitle">Multi-factor health assessment</p>
                        </div>
                        <canvas id="radarChart"></canvas>
                    </div>
                    
                    <!-- Line Chart: Heart Rate Trend -->
                    <div class="dashboard-card secondary-card">
                        <div class="card-header">
                            <h4><i class="fas fa-chart-line"></i> Heart Rate Trend</h4>
                            <p class="card-subtitle">Simulated heart rate over time</p>
                        </div>
                        <canvas id="heartRateChart"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Additional Metrics Section -->
            <div class="dashboard-section">
                <h3 class="section-title"><i class="fas fa-plus-circle"></i> Additional Metrics</h3>
                <div class="dashboard-grid tertiary-grid">
                    <!-- Health Summary Card -->
                    <div class="dashboard-card summary-card">
                        <div class="card-header">
                            <h4><i class="fas fa-clipboard-list"></i> Health Summary</h4>
                            <p class="card-subtitle">Key insights and recommendations</p>
                        </div>
                        <div class="summary-content">
                            <div class="summary-item">
                                <i id="summary-status-icon" class="fas fa-check-circle text-success"></i>
                                <span>Overall Health Status: <strong id="summary-status">Good</strong></span>
                            </div>
                            <div class="summary-item">
                                <i id="summary-risk-icon" class="fas fa-info-circle text-info"></i>
                                <span>Risk Level: <strong id="summary-risk">Low</strong></span>
                            </div>
                            <div class="summary-item">
                                <i class="fas fa-calendar-alt text-warning"></i>
                                <span>Next Check-up: <strong id="summary-checkup">6 months</strong></span>
                            </div>
                            <div class="summary-item">
                                <i class="fas fa-lightbulb text-primary"></i>
                                <span>Recommendation: <strong id="summary-recommendation">Maintain current lifestyle</strong></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Dashboard Footer -->
            <div class="dashboard-footer">
                <div class="footer-content">
                    <div class="dashboard-timestamp">
                        <i class="fas fa-clock"></i>
                        <span>Analysis completed at: <strong id="last-prediction-time">--</strong></span>
                    </div>
                    <div class="dashboard-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Consult a healthcare professional if any values exceed normal thresholds.</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Standalone BMI Calculator Section -->
        <div class="bmi-calculator">
            <h2><i class="fas fa-calculator"></i> BMI Calculator</h2>
            <div class="bmi-form">
                <div class="form-group">
                    <label for="bmi-height">Height (cm)</label>
                    <input type="number" id="bmi-height" name="bmi-height" placeholder="Enter height in cm" min="100" max="250">
                </div>
                <div class="form-group">
                    <label for="bmi-weight">Weight (kg)</label>
                    <input type="number" id="bmi-weight" name="bmi-weight" placeholder="Enter weight in kg" min="20" max="300">
                </div>
                <div class="bmi-result" id="bmi-result">
                    <div class="bmi-value">
                        <span>Your BMI:</span>
                        <span id="bmi-number">--</span>
                    </div>
                    <div class="bmi-category">
                        <span>Category:</span>
                        <span id="bmi-text">--</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer Section -->
    <footer class="site-footer">
        <div class="footer-main">
            <div class="footer-col about">
                <h3>About Us</h3>
                <p>We provide accurate heart disease risk assessment using advanced machine learning algorithms.</p>
            </div>
            <div class="footer-col links">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#"><i class="fas fa-home"></i> Home</a></li>
                    <li><a href="#about"><i class="fas fa-info-circle"></i> About</a></li>
                    <li><a href="#contact"><i class="fas fa-envelope"></i> Contact</a></li>
                </ul>
            </div>
            <div class="footer-col contact">
                <h3>Contact Info</h3>
                <ul>
                    <li><i class="fas fa-envelope"></i> support@heartprediction.com</li>
                    <li><i class="fas fa-phone"></i> +1 234 567 890</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <span>&copy; 2025 Heart Disease Prediction. All rights reserved.</span>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
